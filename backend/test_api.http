### REST Client 接口测试文件
### 使用方法：点击每个请求上方的 "Send Request" 链接即可执行

@baseUrl = http://127.0.0.1:5001

### 1. 健康检查
GET {{baseUrl}}/

### 2. 计算浪费率
GET {{baseUrl}}/compute_waste_rates

### 3. 查询所有日期的菜品提供和浪费情况
GET {{baseUrl}}/days_overview

### 4. 查询特定日期的菜品提供情况
GET {{baseUrl}}/day/2025-11-15

### 5. 添加新一天的数据（带图片路径）
POST {{baseUrl}}/add_day
Content-Type: application/json

{
  "date": "2025-11-23",
  "total_waste": 2.14,
  "servings": [
    {
      "dish_name": "1",
      "quantity": 1.20,
      "image_path": "/images/dish1.jpg",
      "category": "protein"
    },
    {
      "dish_name": "4",
      "quantity": 1.51,
      "image_path": "/images/dish3.png",
      "category": "vegetable"
    },
    {
      "dish_name": "5",
      "quantity": 5.46,
      "image_path": "/images/dish4.png",
      "category": "vegetable"
    }
  ]
}

### 6. 添加另一天的数据（部分带图片路径）
POST {{baseUrl}}/add_day
Content-Type: application/json

{
  "date": "2025-11-13",
  "total_waste": 4.75,
  "servings": [
    {
      "dish_name": "1",
      "quantity": 4.89,
      "image_path": "/images/菜品1_高清.jpg"
    },
    {
      "dish_name": "2",
      "quantity": 3.74,
      "image_path": "/images/菜品2.webp"
    },
    {
      "dish_name": "3",
      "quantity": 5.72
    }
  ]
}

### 7. 测试错误情况 - 缺少必要字段
POST {{baseUrl}}/add_day
Content-Type: application/json

{
  "date": "2025-11-17"
}

### 8. 测试错误情况 - 无效日期格式
POST {{baseUrl}}/add_day
Content-Type: application/json

{
  "date": "2025/11/17",
  "total_waste": 2.5,
  "servings": [
    {
      "dish_name": "测试菜品",
      "quantity": 10.0
    }
  ]
}

### 9. 测试错误情况 - 查询不存在的日期
GET {{baseUrl}}/day/2025-12-31

### 10. 获取所有食物的浪费率（默认按浪费率升序）
GET {{baseUrl}}/dishes_waste_rates

### 11. 获取所有食物的浪费率（按浪费率降序）
GET {{baseUrl}}/dishes_waste_rates?sort=desc

### 12. 获取所有食物的浪费率（按名称升序）
GET {{baseUrl}}/dishes_waste_rates?order_by=name&sort=asc

### 13. 获取所有食物的浪费率（按名称降序）
GET {{baseUrl}}/dishes_waste_rates?order_by=name&sort=desc

### 14. 预测调整菜品投放量的影响（减少到80%）
POST {{baseUrl}}/predict_waste_impact
Content-Type: application/json

{
  "dish_name": "1",
  "adjustment_percentage": 80
}

### 15. 预测调整菜品投放量的影响（增加到120%）
POST {{baseUrl}}/predict_waste_impact
Content-Type: application/json

{
  "dish_name": "2",
  "adjustment_percentage": 120
}

### 16. 预测完全停止某个菜品投放的影响
POST {{baseUrl}}/predict_waste_impact
Content-Type: application/json

{
  "dish_name": "3",
  "adjustment_percentage": 0
}

### 17. 预测大幅增加某个菜品投放的影响
POST {{baseUrl}}/predict_waste_impact
Content-Type: application/json

{
  "dish_name": "1",
  "adjustment_percentage": 150
}

### 18. 测试预测错误情况 - 不存在的菜品
POST {{baseUrl}}/predict_waste_impact
Content-Type: application/json

{
  "dish_name": "不存在的菜品",
  "adjustment_percentage": 80
}

### 19. 测试预测错误情况 - 无效的调整百分比
POST {{baseUrl}}/predict_waste_impact
Content-Type: application/json

{
  "dish_name": "1",
  "adjustment_percentage": 250
}

### 20. 获取某一天投放量最多的菜品
GET {{baseUrl}}/day/2025-11-13/top_dish

### 21. 获取另一天投放量最多的菜品
GET {{baseUrl}}/day/2025-11-22/top_dish

### 22. 测试获取不存在日期的最大投放菜品
GET {{baseUrl}}/day/2025-12-31/top_dish

### 23. 测试无效日期格式的最大投放菜品
GET {{baseUrl}}/day/2025/11/15/top_dish

### ============================================
### 线性规划菜单优化 API 测试
### ============================================

### 24. 基础优化 - 所有必选字段
POST {{baseUrl}}/optimize_menu
Content-Type: application/json

{
  "total_quantity_range": [60, 100],
  "num_dishes": 3,
  "dish_constraints": {
    "1": {"min": 15, "max": 40},
    "2": {"min": 20, "max": 35},
    "3": {"min": 20, "max": 35},
    "4": {"min": 20, "max": 35}
  }
}

### 25. 优化3个菜品
POST {{baseUrl}}/optimize_menu
Content-Type: application/json

{
  "total_quantity_range": [80, 120],
  "num_dishes": 3,
  "dish_constraints": {
    "1": {"min": 10, "max": 30},
    "2": {"min": 15, "max": 25},
    "3": {"min": 12, "max": 28}
  }
}

### 26. 带类别要求的优化 - 必须包含蛋白质
POST {{baseUrl}}/optimize_menu
Content-Type: application/json

{
  "total_quantity_range": [70, 110],
  "num_dishes": 2,
  "dish_constraints": {
    "1": {"min": 20, "max": 40},
    "2": {"min": 15, "max": 35},
    "3": {"min": 20, "max": 35},
    "4": {"min": 20, "max": 35}
  },
  "category_requirements": {
    "require_protein": true
  }
}

### 27. 带类别要求的优化 - 必须包含蛋白质和蔬菜
POST {{baseUrl}}/optimize_menu
Content-Type: application/json

{
  "total_quantity_range": [90, 150],
  "num_dishes": 3,
  "dish_constraints": {
    "1": {"min": 20, "max": 40},
    "2": {"min": 15, "max": 35},
    "3": {"min": 20, "max": 35},
    "4": {"min": 20, "max": 35}
  },
  "category_requirements": {
    "require_protein": true,
    "require_vegetable": true
  }
}

### 28. 完整约束的优化 - 4个菜品
POST {{baseUrl}}/optimize_menu
Content-Type: application/json

{
  "total_quantity_range": [120, 180],
  "num_dishes": 4,
  "dish_constraints": {
    "1": {"min": 20, "max": 40},
    "2": {"min": 15, "max": 30},
    "3": {"min": 10, "max": 25},
    "4": {"min": 12, "max": 28}
  },
  "category_requirements": {
    "require_protein": true,
    "require_vegetable": true
  }
}

### 29. 指定可用菜品的优化 - 从5个菜品中选2个
POST {{baseUrl}}/optimize_menu
Content-Type: application/json

{
  "total_quantity_range": [50, 80],
  "num_dishes": 2,
  "dish_constraints": {
    "1": {"min": 10, "max": 30},
    "2": {"min": 15, "max": 35},
    "3": {"min": 8, "max": 25},
    "4": {"min": 12, "max": 28},
    "5": {"min": 5, "max": 20}
  },
  "available_dishes": [1, 2, 3, 4, 5]
}

### 30. 测试错误情况 - 缺少总量范围
POST {{baseUrl}}/optimize_menu
Content-Type: application/json

{
  "num_dishes": 2,
  "dish_constraints": {
    "1": {"min": 10, "max": 30}
  }
}

### 31. 测试错误情况 - 缺少菜品数量
POST {{baseUrl}}/optimize_menu
Content-Type: application/json

{
  "total_quantity_range": [60, 100],
  "dish_constraints": {
    "1": {"min": 10, "max": 30}
  }
}

### 32. 测试错误情况 - 缺少菜品约束
POST {{baseUrl}}/optimize_menu
Content-Type: application/json

{
  "total_quantity_range": [60, 100],
  "num_dishes": 2
}

### 33. 测试错误情况 - 无效的总量范围
POST {{baseUrl}}/optimize_menu
Content-Type: application/json

{
  "total_quantity_range": [200, 100],
  "num_dishes": 2,
  "dish_constraints": {
    "1": {"min": 10, "max": 30},
    "2": {"min": 15, "max": 25}
  }
}

### 34. 测试错误情况 - 请求的菜品数量超过有约束的菜品
POST {{baseUrl}}/optimize_menu
Content-Type: application/json

{
  "total_quantity_range": [60, 100],
  "num_dishes": 5,
  "dish_constraints": {
    "1": {"min": 10, "max": 30},
    "2": {"min": 15, "max": 25}
  }
}

### 35. 测试约束过紧的情况
POST {{baseUrl}}/optimize_menu
Content-Type: application/json

{
  "total_quantity_range": [10, 15],
  "num_dishes": 3,
  "dish_constraints": {
    "1": {"min": 50, "max": 60},
    "2": {"min": 50, "max": 60},
    "3": {"min": 50, "max": 60}
  }
}

### 36. 最小化浪费的紧致优化
POST {{baseUrl}}/optimize_menu
Content-Type: application/json

{
  "total_quantity_range": [120, 121],
  "num_dishes": 2,
  "dish_constraints": {
    "1": {"min": 40, "max": 80},
    "2": {"min": 40, "max": 80},
    "3": {"min": 10, "max": 25},
    "4": {"min": 12, "max": 28}
  },
  "category_requirements": {
    "require_protein": true
  }
}

### 37. 测试带category的add_day功能
POST {{baseUrl}}/add_day
Content-Type: application/json

{
  "date": "2025-11-16",
  "total_waste": 3.2,
  "servings": [
    {
      "dish_name": "红烧肉",
      "quantity": 18.5,
      "category": "protein",
      "image_path": "/images/红烧肉.jpg"
    },
    {
      "dish_name": "白萝卜汤",
      "quantity": 12.3,
      "category": "vegetable",
      "image_path": "/images/白萝卜汤.png"
    },
    {
      "dish_name": "米饭",
      "quantity": 25.0,
      "category": "staple"
    }
  ]
}

### 38. 宽松的菜单优化测试 - 基于现有菜品数据
POST {{baseUrl}}/optimize_menu
Content-Type: application/json

{
  "total_quantity_range": [40, 80],
  "num_dishes": 3,
  "dish_constraints": {
    "1": {"min": 5, "max": 30},
    "2": {"min": 5, "max": 30},
    "3": {"min": 5, "max": 30},
    "4": {"min": 5, "max": 30}
  },
  "available_dishes": [1, 2, 3, 4],
  "category_requirements": {
    "require_protein": true,
    "require_vegetable": true
  }
}

### 39. 超宽松的菜单优化测试 - 保证有解
POST {{baseUrl}}/optimize_menu
Content-Type: application/json

{
  "total_quantity_range": [30, 100],
  "num_dishes": 2,
  "dish_constraints": {
    "1": {"min": 1, "max": 50},
    "2": {"min": 1, "max": 50},
    "3": {"min": 1, "max": 50},
    "4": {"min": 1, "max": 50}
  },
  "available_dishes": [1, 2, 3, 4]
}

### 40. 测试category验证功能 - 无效category
POST {{baseUrl}}/add_day
Content-Type: application/json

{
  "date": "2025-11-17",
  "total_waste": 2.1,
  "servings": [
    {
      "dish_name": "测试菜品",
      "quantity": 10.0,
      "category": "invalid_category"
    }
  ]
}

### 41. 测试更新已存在菜品的category
POST {{baseUrl}}/add_day
Content-Type: application/json

{
  "date": "2025-11-18",
  "total_waste": 4.5,
  "servings": [
    {
      "dish_name": "1",
      "quantity": 15.0,
      "category": "staple"
    }
  ]
}
